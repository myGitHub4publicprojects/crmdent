{% extends "kadent/base.html" %}
{% load static %}

{% block content %}
{% for message in messages %}
    {{ message|safe }}
{% endfor %}

<form id="fset" method="post" enctype="multipart/form-data">{% csrf_token %}
    {{ formset.management_form }}
    <input type="file" name="images" accept="image/*" id="multiFileBtn" multiple>
    <div id="output"></div>

    <input type="submit" value="Zapisz">
</form>
{% endblock content %}

{% block javascript %}
<script>
var multiFileBtn = document.getElementById('multiFileBtn');
var fset = document.getElementById('fset');
var totalForms = document.getElementById('id_form-TOTAL_FORMS');
var output = document.getElementById('output');


multiFileBtn.addEventListener('change', ()=>{
    totalForms.value = multiFileBtn.files.length;
    for (let f of multiFileBtn.files){
        var newP = document.createElement('p');
        var newSpan = document.createElement('SPAN');
        newSpan.innerText = f.name + ': ';
        var newTextInput = document.createElement('INPUT');
        newTextInput.type = 'text';
        newTextInput.name = f.name;
        newP.appendChild(newSpan);
        newP.appendChild(newTextInput);
        output.appendChild(newP);
    }
});

multiFileBtn.addEventListener('click',()=>{
    output.innerHTML = '';
});

</script>
{% endblock %}